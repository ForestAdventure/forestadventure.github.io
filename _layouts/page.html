---
layout: base
---

<!-- Header -->
<header class="masthead pagehead" {% if page.background_image %} style="background: linear-gradient(to bottom, rgba(92, 77, 66, 0.8) 0%, rgba(92, 77, 66, 0.8) 100%), url('{{ page.background_image }}'); background-position: center; background-repeat: no-repeat; background-attachment: scroll; background-size: cover;"{% endif %} >
  <div class="container h-100">
    <div class="row h-100 align-items-center justify-content-center text-center">
      <div class="col-lg-10 ">
        <h1 class="text-white font-weight-bold">{{ page.title }}</h1>
        <hr class="divider my-4">
      </div>
    </div>
  </div>
</header>

<section class="filter-section">
  <div class="container">
    <div id="global-tag-filter" class="tag-filter" style="margin: 1em 0; display: none;">
      <strong>Фильтр по тегам:</strong>
      <div class="tag-buttons" style="margin-top: 0.5em;"></div>
    </div>
  </div>
</section>

<!-- Any Ready-to-Use sections -->
{% for section in page.sections %}
    {% include {{ section.type }} section=section site=site page=page %}
{% endfor %}

<!-- include content as section -->
{% if content != "" %}
<section class="page-section {{ page.background_style }}">
  <div class="container">
    {{ content }}
  </div>
</section>
{% endif %}

<style>
  {% if page.regulations %}
  body { counter-reset: h1 }
  h1 { counter-reset: h2 }
  h2 { counter-reset: h3 }
  h3 { counter-reset: h4 }
  h2:before {
    counter-increment: h2;
    content: counter(h2) ". "
  }
  h3:before {
    counter-increment: h3;
    content: counter(h2) "." counter(h3) ". "
  }
  h4:before {
    counter-increment: h4;
    content: counter(h2) "." counter(h3) "." counter(h4) ". "
  }
  {% endif %}
  {% if page.table_border %}
  table {
    border-collapse: collapse;
  }
  table, th, td {
    border: 1px solid #dee2e6;
  }
  {% endif %}
  .tag-buttons button {
    margin: 3px;
    padding: 5px 10px;
    border: 1px solid #ccc;
    background: #f8f8f8;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .tag-buttons button.active {
    background: #007bff;
    color: white;
    border-color: #007bff;
    transform: translateY(1px);
  }
</style>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const events = document.querySelectorAll(".event-item");
  const filterBlock = document.getElementById("global-tag-filter");
  const buttonContainer = filterBlock.querySelector(".tag-buttons");

  // Собираем все уникальные теги
  const allTags = new Set();
  events.forEach(event => {
    event.dataset.tags.split(",").forEach(tag => {
      if (tag.trim()) allTags.add(tag.trim());
    });
  });

  // Если тегов нет — выходим
  if (!allTags.size) return;

  // Показать фильтр
  filterBlock.style.display = "";

  // Создаем кнопки
  [...allTags].sort().forEach(tag => {
    const button = document.createElement("button");
    button.textContent = tag;
    button.dataset.tag = tag;
    button.addEventListener("click", function() {
      this.classList.toggle("active");
      filterEvents();
    });
    buttonContainer.appendChild(button);
  });

  function filterEvents() {
    const selectedTags = [...buttonContainer.querySelectorAll(".active")].map(b => b.dataset.tag);
    events.forEach(event => {
      const tags = event.dataset.tags.split(",");
      const match = selectedTags.every(tag => tags.includes(tag));
      event.style.display = selectedTags.length === 0 || match ? "" : "none";
    });
  }
});
</script>

